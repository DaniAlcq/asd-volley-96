<!DOCTYPE html>
<html lang="it">
<head>
  <meta name="theme-color" content="#121212">
  <meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ASD VOLLEY 96</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="header-tot">
    <img class="brand-logo" src="img/logonuovobianco.png" alt="Logo">
  
    <!-- Bottone hamburger -->
    <button class="hamburger" id="hamburger" aria-label="Apri menu">
      &#9776; <!-- icona ‚ò∞ -->
    </button>
    
    <nav id="navbar">
      <a href="index.html" data-url="index.html">Home</a>
      <a href="squadre.html" data-url="squadre.html">Squadre</a>
      <a href="calendario.html" data-url="calendario.html">Calendario e Risultati</a>
      <a href="classifiche.html" data-url="classifiche.html">Classifiche</a>
      <a href="contatti.html" data-url="contatti.html">Contatti</a>
    </nav>
  
    <!-- Icona Instagram -->
   <!-- Contenitore icone social -->
<div class="social-icons">
  <a href="https://www.instagram.com/a.s.d.volley96/" target="_blank" rel="noopener noreferrer">
    <img class="social-logo-insta" src="img/instagram.png" alt="Instagram">
  </a>

  <a href="https://www.facebook.com/asdvolley96" target="_blank" rel="noopener noreferrer">
    <img class="social-logo-facebook" src="img/facebook.png" alt="Facebook">
  </a>
</div>

  </header>
  
  

  <main>
    <div>

    
      <div class="news-wrapper">
        
      
        <!-- Carosello Desktop -->
        <section class="news-carousel">
          <button class="prev">‚ùÆ</button>
          <div class="slides">
            <!-- Slide generate da JS desktop -->
          </div>
          <button class="next">‚ùØ</button>
        </section>
    
         
      </div>
      
        
        
        <section class="news-grid"></section>
     
      
    </div>
    

    <a href="https://www.fimaformazione.it/" target="_blank" rel="noopener noreferrer">
      <div class="sponsor-banner">
        <img src="img/cropped-Fima-Logo-01.png" alt="Sponsor Logo" class="sponsor-logo">
      </div>
    </a>

    <section class="results-section">
      <h2 class="results-title">Ultimi Risultati</h2>
      <div class="buttons-filter">
        <button data-cat="Femminile" class="filter-btn active">Femminile</button>
        <button data-cat="Maschile" class="filter-btn">Maschile</button>
      </div>
      <div class="results-grid" id="results-container">
        <!-- Le card dei risultati saranno inserite dinamicamente qui -->
      </div>
    </section>
    
    

    <section class="mvp-section">
      <h2 class="mvp-title">Ultimi scarabei di giornata</h2>
      <div class="mvp-grid" id="scarabei-container"></div>
    </section>
    
   
    
      
   
    <section class="teams-section">
      <h2 class="teams-title">Le nostre squadre</h2>
      
      <div class="teams-grid">
        <a href="squadre.html?cat=Femminile" data-url="squadre.html?cat=Femminile">
          <div class="team-card">
            <img src="img/squadra_femminile/femminile.jpg" alt="Squadra 1">
            <h3>Serie C femminile</h3>
          </div>
        </a>
       
        <a href="squadre.html?cat=Maschile" data-url="squadre.html?cat=Maschile">
          <div class="team-card">
            <img src="img/squadra_maschile/maschile.jpg" alt="Squadra 2">
            <h3>Serie C maschile</h3>
          </div>
        </a>
        
    </section>

 <script src="js/fade.js"></script>
  </main>

  <footer class="site-footer">
    <p>¬© <span id="year"></span> ASD VOLLEY 96 ‚Äî Tutti i diritti riservati</p>
    <p>
      Web design & sviluppo ¬© 2025 
      <a href="mailto:danilo.alacqua@example.com">Danilo Alacqua</a>

    </p>
  </footer>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const y = document.getElementById('year');
      if (y) y.textContent = new Date().getFullYear();
    });
  </script>
  

  <script src="js/script.js" defer></script>
  <script src="js/menu.js" defer></script>
  <script>
    // ======= Google Sheets via Opensheet: config + helper =======
    const SHEET_ID = "1ucM1JY5MXHF7-9mpjp2mfB41TvoA1ziMUGGz86woQXA"; // <-- sostituisci con il tuo ID se cambia
    const GS = (tab) => `https://opensheet.elk.sh/${SHEET_ID}/${encodeURIComponent(tab)}`;
    
    async function fetchSheet(tab) {
      const url = GS(tab);
      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) throw new Error(`Fetch fallito: ${tab} (${res.status})`);
      return res.json(); // array di righe, chiavi = intestazioni del foglio
    }
    
    // Utility
    const tidy   = (s) => (typeof s === "string" ? s.trim() : s);
    const fixImg = (s) => tidy(s);
    const parseSets = (str) =>
      tidy(str || "")
        ?.split(",")
        .map(s => s.trim())
        .filter(Boolean) || [];
    
    // ======================== App ========================
    document.addEventListener("DOMContentLoaded", () => {
      // Helper DOM
      const $  = (sel, root = document) => root.querySelector(sel);
      const $$ = (sel, root = document) => [...root.querySelectorAll(sel)];
    
      /* ========================
         CAROSELLO NEWS (tab: Carosello)
      ======================== */
      async function fetchCarosello() {
        try {
          const rows = await fetchSheet("Carosello");
          const slidesData = rows.map(r => ({
            immagine: fixImg(r.immagine),
            caption: tidy(r.caption),
            descrizione: tidy(r.descrizione || "")
          }));
    
          const slidesContainer = $(".news-carousel .slides");
          if (!slidesContainer) return;
          slidesContainer.innerHTML = "";
    
          slidesData.forEach(slide => {
            const slideDiv = document.createElement("div");
            slideDiv.className = "slide";
            slideDiv.innerHTML = `
              <div class="slide-left">
                <img src="${slide.immagine}" alt="${slide.caption}">
              </div>
              <div class="slide-right">
                <h3>${slide.caption}</h3>
                <p>${slide.descrizione}</p>
              </div>
            `;
            slidesContainer.appendChild(slideDiv);
          });
    
          initCarosello();
        } catch (err) {
          console.error("Carosello:", err);
        }
      }
    
      function initCarosello() {
        const wrapper = $(".news-carousel .slides");
        const slides  = $$(".news-carousel .slide");
        const prevBtn = $(".news-carousel .prev");
        const nextBtn = $(".news-carousel .next");
        if (!wrapper || !slides.length || !prevBtn || !nextBtn) return;
    
        const total = slides.length;
        let current = 0;
    
        function updateSlides() {
          wrapper.style.transform = `translateX(${-current * 100}%)`;
        }
    
        prevBtn.addEventListener("click", () => {
          current = (current - 1 + total) % total;
          updateSlides();
        });
    
        nextBtn.addEventListener("click", () => {
          current = (current + 1) % total;
          updateSlides();
        });
    
        document.addEventListener("keydown", (e) => {
          if (e.key === "ArrowLeft")  prevBtn.click();
          if (e.key === "ArrowRight") nextBtn.click();
        });
    
        updateSlides();
      }
    
      fetchCarosello();
    
      /* ========================
         NEWS GRID (tab: News)
      ======================== */
      let newsData = [];
    
      async function fetchNews() {
        try {
          const rows = await fetchSheet("News");
          newsData = rows.map(r => ({
            id: tidy(r.id),
            titolo: tidy(r.titolo),
            immagine: fixImg(r.immagine),
            contenuto: tidy(r.contenuto)
          }));
    
          const newsGrid = $(".news-grid");
          if (!newsGrid) return;
          newsGrid.innerHTML = "";
    
          newsData.forEach(news => {
            const figure = document.createElement("figure");
            figure.className = "news-card";
            figure.setAttribute("data-id", news.id);
            figure.style.cursor = "pointer";
            figure.innerHTML = `
              <img src="${news.immagine}" alt="${news.titolo}">
              <figcaption>${news.titolo}</figcaption>
            `;
            newsGrid.appendChild(figure);
          });
        } catch (err) {
          console.error("News:", err);
        }
      }
    
      function showNews(id, replace = false) {
        const main = document.querySelector("main");
        if (!main) return;
    
        const news = newsData.find((n) => String(n.id) === String(id));
        if (!news) {
          main.innerHTML = `<p>News non trovata.</p>`;
          return;
        }
    
        main.innerHTML = `
          <article class="news-detail">
            <h2>${news.titolo}</h2>
            <img src="${news.immagine}" alt="${news.titolo}">
            <p>${news.contenuto}</p>
            <button class="back-btn" onclick="history.back()">‚¨Ö Torna indietro</button>
          </article>
        `;
    
        window.scrollTo({ top: 0 });
        if (replace) history.replaceState({ id }, "", `#${id}`);
        else history.pushState({ id }, "", `#${id}`);
      }
    
      async function initNewsGrid() {
        await fetchNews();
    
        document.addEventListener("click", (e) => {
          const card = e.target.closest(".news-card");
          if (card) {
            e.preventDefault();
            const id = card.getAttribute("data-id");
            showNews(id);
          }
        });
    
        window.addEventListener("popstate", (e) => {
          if (e.state?.id) showNews(e.state.id, true);
          else location.reload();
        });
    
        const hashId = location.hash.slice(1);
        if (hashId) showNews(hashId, true);
      }
      initNewsGrid();
    
      /* ========================
         SCARABEI DI GIORNATA (tab: Scarabei)
      ======================== */
      (async function loadScarabei(){
        try {
          const rows = await fetchSheet("Scarabei");
          const container = document.getElementById("scarabei-container");
          if (!container) return;
          container.innerHTML = "";
    
          rows.forEach(player => {
            const card = document.createElement("div");
            card.className = "mvp-card";
            card.innerHTML = `
  <img src="${fixImg(player.immagine)}" alt="${tidy(player.nome)}">
  <h3>${tidy(player.nome)}</h3>
  <p>${tidy(player.categoria)}</p>
  ${player.prestazione ? `
    <p>
      <strong>Prestazione üèê</strong><br>
      ${tidy(player.prestazione)}
    </p>` : ""}
`;

            container.appendChild(card);
          });
        } catch (e) {
          console.error("Scarabei:", e);
        }
      })();
    
      /* ========================
         ULTIMI RISULTATI (tab: Risultati)
      ======================== */
      const buttons = $$(".filter-btn");
      const resultsContainer = $("#results-container");
    
      function renderResults(category, rows) {
        if (!resultsContainer) return;
        resultsContainer.innerHTML = "";
        const filtered = rows.filter(
          (m) => (m.categoria || "").toLowerCase() === category.toLowerCase()
        );
    
        filtered.slice(0, 3).forEach((match) => {
          const card = document.createElement("div");
          card.className = "result-card";
          card.innerHTML = `
            <h4 class="result-day">${tidy(match.giorno) || ""}</h4>
            <div class="logos">
              <div class="team">
                <img src="${fixImg(match.squadraCasa_logo)}" alt="${tidy(match.squadraCasa_nome) || ""}">
                <span>${tidy(match.squadraCasa_nome) || ""}</span>
              </div>
              <div class="resCasa">${tidy(match.risultatoCasa) ?? ""}</div>
              <div class="vs">-</div>
              <div class="resOsp">${tidy(match.risultatoOspite) ?? ""}</div>
              <div class="team">
                <img src="${fixImg(match.squadraOspite_logo)}" alt="${tidy(match.squadraOspite_nome) || ""}">
                <span>${tidy(match.squadraOspite_nome) || ""}</span>
              </div>
            </div>
            <ul class="result-sets">
              ${parseSets(match.sets).map((s) => `<li>${s}</li>`).join("")}
            </ul>
          `;
          resultsContainer.appendChild(card);
        });
      }
    
      (async () => {
        try {
          const rows = await fetchSheet("Risultati");
          renderResults("Femminile", rows);
    
          buttons.forEach((btn) => {
            btn.addEventListener("click", () => {
              buttons.forEach((b) => b.classList.remove("active"));
              btn.classList.add("active");
              renderResults(btn.dataset.cat, rows);
            });
          });
        } catch (error) {
          console.error("Risultati:", error);
        }
      })();
    
      /* ========================
         MENU ATTIVO
      ======================== */
      const navLinks = $$("nav a");
      const currentPage = window.location.pathname.split("/").pop() || "index.html";
      navLinks.forEach((link) => {
        const linkPage = link.getAttribute("href");
        if (linkPage === currentPage) link.classList.add("active");
        else link.classList.remove("active");
      });
    });
    </script>
    

</body>
</html>
